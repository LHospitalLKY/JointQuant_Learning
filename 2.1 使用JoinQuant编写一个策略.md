# 使用JoinQuant编写一个量化策略
1.1节使用一个小例子来说明了量化策略编写的基本框架，这一部分对JoinQuant量化策略编写进行更为详细的介绍。


## 如何使用JoinQuant数据
使用JoinQuant可以获取**行情数据**和**财务数据**。

### 1. 行情数据
JoinQuant的API文档中，有对能够获取的行情数据和获取方法进行介绍。

通常来说，行情数据是存储在SecurityUnitData中，其基本属性有：
* open 时间段开始时的价格
* close 时间段结束时的价格
* low 最低价
* high 最高价
* volume 成交的股票数量
* money 成交的金额
* factor 前复权因子
* high_limit 涨停价
* low_limit 跌停价
* price 这段时间的平均价
* pre_close 前一个单位时间结束时的价格
* paused bool 标示这支股票是否停牌

行情数据的获取方式有四种：

1. 直接在回测中从data读取
	* 这种方法只能在策略中使用
	* 可以获得额外属性，例如security、returns、isnan、vwap等
	* 只能调用当期时间的数据
	* 只能在handle_data中使用
	
2. 使用attribute_history获取
	* 只能在策略中使用
	* 只能取得当前时间前n个单位时间的数据
	* 只能获取单独一个股票的数据，但是可以同时获得多个字段的数据
	* 可以选择是否跳过停牌日期
	
3. history获取
	* 只能在策略中使用
	* 只能取得当前时间前n个单位时间的数据
	* 可以同时获得多个股票的数据，但是只能获得相同的一个数据字段
	* 不能选择跳过停牌日期
	
4. get_current_data获取
	* 仅能获取当前时间数据
	* 只能获取涨跌停价、是否停牌、开盘价
	* 只能在策略中使用
	* 可以同时获得多个股票、多个字段数据

5. get_price获取
	* 使用较为困难
	* 在策略和研究中都能使用
	* 可以获取任意指定时间段的数据
	* 可以同时获得多个股票的数据、多个字段数据
	* 不能跳过停牌日期
	get_price的使用较为复杂，因此会单独列出来进行介绍。

### 2. 财务数据
JoinQuant中使用get_fundamentals来获取基本面数据，财务数据包括在基本面数据中。
财务数据主要包括有股票财务数据、市值数据等，这些内容可以在帮助文档中查找出来。

get_fundamentals()函数使用方法如下：
```python
get_fundamentals(query(
		# 查询内容
		valuation.code	# 市值表.股票代码
		, valuation.market_cap	# 市值表.市值
		, valuation.pe_ratio	# 市值表.动态市盈率
		, income.total_operation_revenue	# 利润表.营业总收入
	).filetr(
		# 筛选条件
		valuation.market_cap > 1000	# 市值表.市值 > 1000
		, valuation.pe_ratio < 10	# 市值表.动态市盈率 < 10
		, income.total_operating_revenue > 2e10	 # 利润表.营业总收入 > 2e10
	).order_by(
		# 排序方法
		valuation.market_cap.desc()		# 按照 市值表.市值 进行降序排列
	).limit(
		# 数量限制
		100
	), data = '2015-10-15' # 时间
	)
```



## 如何设置股票池
设置股票池有多种方式，有get_index_stocks()、get_industry_stocks()以及自行设置股票池：

按index设置：
```python
# 获取所有沪深300的股票，设为股票池
stocks = get_index_stocks('0003000.XSHG')
set_universe(stocks)
```
按industry设置：
```python
# 获取计算机/互联网行业的成分股，设为股票池
stocks = get_industry_stocks('I64')
set_universe(stocks)
```
自定义设置：
```python
stocks = ['000009.XSHE', '002222.XSHE', '000005.XSHE', '000002.XSHE']
set_universe(stocks)
```

需要注意的是，在API文档中set_universe()函数被称为**老函数**，因此上述内容是否正确需要验证。



## 如何买入/卖出股票
卖出买入股票都是使用订单order操作的。下订单的方法有四种：order、order_target、order_value、
order_target_value。

* order 买卖一定数量的股票
* order_target 通过买卖，将股票仓位调整至一定数量(股)
* order_value 买卖一定价值量(元)的股票
* order_target_value 通过买卖，将股票仓位调整至一定价值量(元)

除了下单之外，还有别的一些订单相关操作


	 



























